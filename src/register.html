{% extends "_common.html" %}

{% block title %}Register | Aerospace Jam{% endblock %}

{% block head %}
    <meta name="description" content="Register your team for Aerospace Jam, a high school robotics competition focused on the challenges of space exploration and aerospace.">
    
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
{% endblock %}

{% block header %}{% endblock %}
{% block nav %}{% endblock %}

{% block main %}
    <!-- Header -->
    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 shadow-sm">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="/" class="text-2xl font-bold text-green-800">
                Aerospace Jam
            </a>
            <nav class="hidden md:flex space-x-8">
                <a href="/#about" class="text-gray-600 hover:text-green-600 transition-colors">About</a>
                <a href="/#details" class="text-gray-600 hover:text-green-600 transition-colors">Details</a>
                <a href="/#schedule" class="text-gray-600 hover:text-green-600 transition-colors">Schedule</a>
                <a href="/#faq" class="text-gray-600 hover:text-green-600 transition-colors">FAQ</a>
                <a href="https://discord.com/invite/ShsPVMzpyW" target="_blank" class="text-gray-600 hover:text-green-600 transition-colors">Discord</a>
            </nav>
            <a href="/" class="bg-green-600 text-white font-bold py-2 px-5 rounded-full hover:bg-green-700 transition-transform hover:scale-105">
                Back to Home
            </a>
        </div>
    </header>

    <!-- Main Content -->
    <main>
        <!-- Registration Section -->
        <section class="py-20 bg-green-50">
            <div class="container mx-auto px-6 max-w-4xl">
                <div class="text-center mb-12">
                    <h1 class="text-4xl md:text-5xl font-bold text-green-800">Register Your Team</h1>
                    <p class="mt-4 text-lg text-gray-600 max-w-3xl mx-auto">
                        Complete the form below to sign up for the Aerospace Jam. We're excited to have you on board for the Mars Sample Return mission!
                    </p>
                </div>

                <div class="bg-white p-8 md:p-12 rounded-lg shadow-xl">
                    <!-- IMPORTANT: Replace the action attribute with your Formspree endpoint -->
                    <form action="https://formspree.io/f/xeorjbol" method="POST" class="space-y-8">
                        
                        <!-- Team Information -->
                        <div>
                            <h2 class="text-2xl font-bold text-green-700 border-b-2 border-green-200 pb-2 mb-6">Team Information</h2>
                            <div class="grid grid-cols-1 gap-6">
                                <div>
                                    <label for="team_name" class="block text-lg font-medium text-gray-700">Team Name</label>
                                    <input type="text" name="team_name" id="team_name" class="mt-2 block w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 sm:text-lg" required>
                                </div>
                            </div>
                        </div>

                        <!-- Mentor Information -->
                        <div>
                            <h2 class="text-2xl font-bold text-green-700 border-b-2 border-green-200 pb-2 mb-6">Mentor Information</h2>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label for="mentor_name" class="block text-lg font-medium text-gray-700">Full Name</label>
                                    <input type="text" name="mentor_name" id="mentor_name" class="mt-2 block w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 sm:text-lg" required>
                                </div>
                                <div>
                                    <label for="mentor_email" class="block text-lg font-medium text-gray-700">Email Address</label>
                                    <input type="email" name="mentor_email" id="mentor_email" class="mt-2 block w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 sm:text-lg" required>
                                </div>
                                <div>
                                    <label for="mentor_phone" class="block text-lg font-medium text-gray-700">Phone Number</label>
                                    <input type="tel" name="mentor_phone" id="mentor_phone" class="mt-2 block w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 sm:text-lg">
                                </div>
                                <div>
                                    <label for="affiliation" class="block text-lg font-medium text-gray-700">School or Organization</label>
                                    <input type="text" name="affiliation" id="affiliation" class="mt-2 block w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 sm:text-lg">
                                </div>
                            </div>
                        </div>

                        <!-- Student Information -->
                        <div>
                            <h2 class="text-2xl font-bold text-green-700 border-b-2 border-green-200 pb-2 mb-6">Student Members (2-10 students)</h2>
                            <div id="student-members" class="space-y-6">
                                <!-- Student 1 (Required minimum) -->
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 p-4 border border-gray-200 rounded-lg relative">
                                    <h3 class="md:col-span-3 text-lg font-bold text-gray-800">Student 1</h3>
                                    <div>
                                        <label for="student_name_1" class="block text-md font-medium text-gray-700">Full Name</label>
                                        <input type="text" name="student_name_1" id="student_name_1" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500" required>
                                    </div>
                                    <div>
                                        <label for="student_email_1" class="block text-md font-medium text-gray-700">Email Address</label>
                                        <input type="email" name="student_email_1" id="student_email_1" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500" required>
                                    </div>
                                    <div>
                                        <label for="student_grade_1" class="block text-md font-medium text-gray-700">Grade Level</label>
                                        <input type="number" name="student_grade_1" id="student_grade_1" min="6" max="12" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500" required>
                                    </div>
                                    <!-- Remove button (initially hidden, shown if count > MIN_STUDENTS) -->
                                    <button type="button" class="remove-student-btn absolute top-2 right-2 p-2 rounded-full bg-red-100 text-red-600 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2" style="display: none;">
                                        <span class="sr-only">Remove student</span>
                                        <svg class="h-5 w-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 7h14m-9 3v8m4-8v8M10 3h4a1 1 0 0 1 1 1v3H9V4a1 1 0 0 1 1-1ZM6 7h12v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7Z"/>
                                        </svg>
                                    </button>
                                </div>
                                <!-- Student 2 (Required minimum) -->
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 p-4 border border-gray-200 rounded-lg relative">
                                    <h3 class="md:col-span-3 text-lg font-bold text-gray-800">Student 2</h3>
                                    <div>
                                        <label for="student_name_2" class="block text-md font-medium text-gray-700">Full Name</label>
                                        <input type="text" name="student_name_2" id="student_name_2" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500" required>
                                    </div>
                                    <div>
                                        <label for="student_email_2" class="block text-md font-medium text-gray-700">Email Address</label>
                                        <input type="email" name="student_email_2" id="student_email_2" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500" required>
                                    </div>
                                    <div>
                                        <label for="student_grade_2" class="block text-md font-medium text-gray-700">Grade Level</label>
                                        <input type="number" name="student_grade_2" id="student_grade_2" min="6" max="12" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500" required>
                                    </div>
                                    <!-- Remove button (initially hidden, shown if count > MIN_STUDENTS) -->
                                    <button type="button" class="remove-student-btn absolute top-2 right-2 p-2 rounded-full bg-red-100 text-red-600 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2" style="display: none;">
                                        <span class="sr-only">Remove student</span>
                                        <svg class="h-5 w-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 7h14m-9 3v8m4-8v8M10 3h4a1 1 0 0 1 1 1v3H9V4a1 1 0 0 1 1-1ZM6 7h12v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7Z"/>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <button type="button" id="add-student" class="mt-6 bg-green-100 text-green-800 font-bold py-2 px-4 rounded-lg hover:bg-green-200 transition-colors">
                                + Add Another Student (Up to 10)
                            </button>
                        </div>

                        <!-- Submission & Terms -->
                        <div class="pt-6 border-t border-gray-200">
                             <div class="flex items-start">
                                <div class="flex items-center h-5">
                                <input id="terms" name="terms" type="checkbox" class="focus:ring-green-500 h-4 w-4 text-green-600 border-gray-300 rounded" required>
                                </div>
                                <div class="ml-3 text-lg">
                                <label for="terms" class="font-medium text-gray-700">I have read and agree to the competition <a href="https://docs.aerospacejam.org/" target="_blank" class="text-green-600 hover:underline">rules and guidelines</a>.</label>
                                </div>
                            </div>
                        </div>

                        <div class="text-center">
                            <button type="submit" class="bg-green-600 text-white font-bold py-4 px-12 rounded-full text-xl hover:bg-green-700 transition-transform hover:scale-105 inline-block">
                                Submit Registration
                            </button>
                        </div>

                    </form>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 text-gray-400">
        <div class="container mx-auto px-6 py-8 text-center">
            <p>&copy; 2024 Aerospace Jam. All Rights Reserved.</p>
            <div class="mt-4">
                <p>Questions? <a href="mailto:mmortens@carrollu.edu" class="text-green-400 hover:underline">mmortens@carrollu.edu</a> or <a href="mailto:henrymartin.co@outlook.com" class="text-green-400 hover:underline">henrymartin.co@outlook.com</a></p>
                <p class="mt-2">Join our <a href="https://discord.com/invite/ShsPVMzpyW" target="_blank" class="text-green-400 hover:underline">Discord community</a></p>
            </div>
        </div>
    </footer>
    
    <script>
        const MIN_STUDENTS = 2;
        const MAX_STUDENTS = 10;
        
        let currentStudentCount; // Will be updated dynamically

        const studentContainer = document.getElementById('student-members');
        const addStudentButton = document.getElementById('add-student');

        // Function to update the visibility of add/remove buttons and student numbering
        function updateStudentUI() {
            currentStudentCount = studentContainer.children.length;

            // Update add button visibility
            if (addStudentButton) {
                addStudentButton.style.display = (currentStudentCount < MAX_STUDENTS) ? 'inline-block' : 'none';
                addStudentButton.textContent = `+ Add Another Student (Up to ${MAX_STUDENTS - currentStudentCount} more)`;
                if (currentStudentCount >= MAX_STUDENTS) {
                    addStudentButton.textContent = 'Maximum Students Reached';
                }
            }

            // Update remove buttons visibility and re-number students
            Array.from(studentContainer.children).forEach((studentBlock, index) => {
                const h3 = studentBlock.querySelector('h3');
                if (h3) {
                    h3.textContent = `Student ${index + 1}`;
                }

                const removeBtn = studentBlock.querySelector('.remove-student-btn');
                if (removeBtn) {
                    removeBtn.style.display = (currentStudentCount > MIN_STUDENTS) ? 'inline-flex' : 'none';
                }
            });
        }

        // Function to add a new student block
        function addStudent() {
            if (currentStudentCount < MAX_STUDENTS) {
                const newStudentIndex = currentStudentCount + 1; // Visual index for the new student

                const newStudentBlock = document.createElement('div');
                newStudentBlock.className = 'grid grid-cols-1 md:grid-cols-3 gap-6 p-4 border border-gray-200 rounded-lg relative';
                newStudentBlock.innerHTML = `
                    <h3 class="md:col-span-3 text-lg font-bold text-gray-800">Student ${newStudentIndex}</h3>
                    <div>
                        <label for="student_name_${newStudentIndex}" class="block text-md font-medium text-gray-700">Full Name</label>
                        <input type="text" name="student_name_${newStudentIndex}" id="student_name_${newStudentIndex}" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500" required>
                    </div>
                    <div>
                        <label for="student_email_${newStudentIndex}" class="block text-md font-medium text-gray-700">Email Address</label>
                        <input type="email" name="student_email_${newStudentIndex}" id="student_email_${newStudentIndex}" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500" required>
                    </div>
                    <div>
                        <label for="student_grade_${newStudentIndex}" class="block text-md font-medium text-gray-700">Grade Level</label>
                        <input type="number" name="student_grade_${newStudentIndex}" id="student_grade_${newStudentIndex}" min="6" max="12" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500" required>
                    </div>
                    <button type="button" class="remove-student-btn absolute top-2 right-2 p-2 rounded-full bg-red-100 text-red-600 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2">
                        <span class="sr-only">Remove student</span>
                        <svg class="h-5 w-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 7h14m-9 3v8m4-8v8M10 3h4a1 1 0 0 1 1 1v3H9V4a1 1 0 0 1 1-1ZM6 7h12v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7Z"/>
                        </svg>
                    </button>
                `;
                studentContainer.appendChild(newStudentBlock);
                newStudentBlock.querySelector('.remove-student-btn').addEventListener('click', removeStudent);
                updateStudentUI();
            }
        }

        // Function to remove a student block
        function removeStudent(event) {
            const studentBlock = event.target.closest('.grid.rounded-lg');
            if (studentBlock && currentStudentCount > MIN_STUDENTS) {
                studentBlock.remove();
                updateStudentUI(); // Update UI after removal
            }
        }

        // Initialize event listeners and UI on page load
        document.addEventListener('DOMContentLoaded', () => {
            if (addStudentButton) {
                addStudentButton.addEventListener('click', addStudent);
            }
            
            // Attach remove listeners to initially rendered students
            document.querySelectorAll('#student-members .remove-student-btn').forEach(btn => {
                btn.addEventListener('click', removeStudent);
            });
            updateStudentUI(); // Initial UI update
        });
    </script>
{% endblock %}